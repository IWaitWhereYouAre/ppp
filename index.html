<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valentine Bloom ✦</title>
  <meta name="description" content="A perfect Valentine flower with constellation sparkles." />
  <style>
    :root{
      --bg1:#070711;
      --bg2:#12081c;
      --bg3:#1a0b20;

      --ink:#fff7fb;
      --muted:rgba(255,247,251,.78);
      --dim:rgba(255,247,251,.58);

      --rose:#ff4f93;
      --blush:#ff9bc4;
      --gold:#ffd38a;
      --vio:#c7b2ff;
      --mint:#86ffe1;

      --glass: rgba(255,255,255,.055);
      --border: rgba(255,255,255,.14);
      --shadow: 0 22px 70px rgba(0,0,0,.55);

      --glow: rgba(255, 125, 178, .35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100svh;
      color:var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 900px at 15% 10%, rgba(255,79,147,.20), transparent 60%),
        radial-gradient(1000px 700px at 85% 20%, rgba(199,178,255,.18), transparent 58%),
        radial-gradient(1000px 800px at 45% 90%, rgba(255,211,138,.12), transparent 62%),
        linear-gradient(180deg, var(--bg1), var(--bg2) 55%, var(--bg3));
      overflow-x:hidden;
    }
    body::before{
      content:"";
      position:fixed; inset:0; pointer-events:none;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.06) 0 1px, transparent 2px) 0 0/140px 140px,
        radial-gradient(circle at 80% 60%, rgba(255,255,255,.05) 0 1px, transparent 2px) 0 0/180px 180px;
      mix-blend-mode: screen;
      opacity:.35;
    }

    .wrap{ max-width:980px; margin:0 auto; padding:28px 18px 44px; display:grid; gap:16px; }
    header{ display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap; align-items:center; }

    .badge{
      display:inline-flex; align-items:center; gap:.55rem;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:999px;
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      font-size: 13px;
      color: var(--muted);
      user-select:none;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--rose) 60%, rgba(255,79,147,.25) 75%);
      box-shadow: 0 0 22px rgba(255,79,147,.55);
    }

    .card{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border-radius: 24px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px; pointer-events:none;
      background:
        radial-gradient(900px 600px at 50% 20%, rgba(255,79,147,.12), transparent 60%),
        radial-gradient(800px 540px at 15% 80%, rgba(255,211,138,.08), transparent 60%),
        radial-gradient(900px 700px at 85% 85%, rgba(199,178,255,.10), transparent 55%),
        radial-gradient(1200px 900px at 50% 50%, transparent 55%, rgba(0,0,0,.25) 100%);
    }

    .grid{
      position:relative;
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 14px;
      padding: 16px;
      align-items:stretch;
    }
    @media (max-width: 900px){ .grid{ grid-template-columns:1fr; } }

    h1{ margin:10px 0 6px; font-size: clamp(22px, 3.2vw, 36px); line-height:1.08; letter-spacing:.2px; }
    p{ margin:0; color:var(--muted); line-height:1.6; font-size:15px; }
    .note{
      margin-top:12px;
      padding: 12px;
      border-radius: 16px;
      border: 1px dashed rgba(255,255,255,.18);
      color: var(--dim);
      background: rgba(0,0,0,.14);
      font-size: 13px;
      line-height:1.55;
    }

    .controls{
      display:grid;
      gap:10px;
      margin-top:12px;
    }
    .row{
      display:grid;
      grid-template-columns: 130px 1fr 58px;
      gap:10px;
      align-items:center;
      font-size: 13px;
      color: var(--muted);
    }
    input[type="range"]{
      width:100%;
      accent-color: var(--rose);
    }
    .value{
      text-align:right;
      font-variant-numeric: tabular-nums;
      color: rgba(255,247,251,.9);
    }

    .btns{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px; }
    button{
      appearance:none; border:0; cursor:pointer;
      border-radius: 14px; padding: 10px 12px;
      font-weight: 720; letter-spacing:.2px;
      color: rgba(14,8,18,.92);
      background: linear-gradient(135deg, var(--rose), var(--gold));
      box-shadow: 0 16px 34px rgba(255,79,147,.22);
      transition: transform .12s ease, filter .12s ease;
    }
    button:hover{ transform: translateY(-1px); filter: brightness(1.03); }
    button:active{ transform: translateY(0px) scale(.99); }
    .ghost{
      background: rgba(255,255,255,.05);
      color: var(--ink);
      border: 1px solid rgba(255,255,255,.16);
      box-shadow:none;
    }

    .stage{
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 14px;
      min-height: 520px;
    }

    .frame{
      width: min(460px, 100%);
      aspect-ratio: 1 / 1;
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.14);
      background: radial-gradient(800px 500px at 50% 30%, rgba(255,79,147,.10), rgba(0,0,0,.12));
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
    }

    canvas{ width:100%; height:100%; display:block; }

    .hint{
      position:absolute;
      left:14px; bottom:12px;
      font-size:12px;
      color: rgba(255,247,251,.6);
      user-select:none;
    }

    footer{
      color: rgba(255,247,251,.55);
      font-size: 12px;
      padding: 0 6px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="badge"><span class="dot"></span> Valentine Bloom (perfect flower) ✦</div>
      <div class="badge" id="dateBadge"></div>
    </header>

    <section class="card">
      <div class="grid">
        <div>
          <h1 id="headline">For my hardworking star ✦</h1>
          <p id="subhead">
            A perfect flower that keeps blooming—because you deserve softness, even on internship days.
          </p>

          <div class="controls">
            <div class="row">
              <div>Petals</div>
              <input id="petals" type="range" min="40" max="240" value="140" />
              <div class="value" id="petalsV">140</div>
            </div>
            <div class="row">
              <div>Bloom</div>
              <input id="bloom" type="range" min="10" max="100" value="72" />
              <div class="value" id="bloomV">72</div>
            </div>
            <div class="row">
              <div>Petal size</div>
              <input id="size" type="range" min="10" max="100" value="56" />
              <div class="value" id="sizeV">56</div>
            </div>
            <div class="row">
              <div>Sparkle</div>
              <input id="sparkle" type="range" min="0" max="100" value="55" />
              <div class="value" id="sparkleV">55</div>
            </div>
          </div>

          <div class="btns">
            <button id="animateBtn">Bloom now ✨</button>
            <button class="ghost" id="saveBtn">Download as PNG</button>
            <button class="ghost" id="personalizeBtn">Personalize text ✍️</button>
          </div>

          <div class="note" id="note">
            <b>tiny reminder:</b> You don’t have to earn rest. You deserve it.
            You’re allowed to be ambitious <i>and</i> happy. I’m proud of you.
          </div>
        </div>

        <div class="stage">
          <div class="frame">
            <canvas id="c" width="1024" height="1024"></canvas>
            <div class="hint">Tip: drag sliders → your flower changes live ✦</div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <div>Made with ♡ + stardust.</div>
      <div>GitHub Pages ready (single file).</div>
    </footer>
  </div>

  <script>
    // Date badge (Bangkok-friendly display)
    const now = new Date();
    document.getElementById("dateBadge").textContent =
      now.toLocaleDateString("en-GB", { weekday:"long", year:"numeric", month:"short", day:"numeric" });

    const canvas = document.getElementById("c");
    const ctx = canvas.getContext("2d");

    // Controls
    const el = {
      petals: document.getElementById("petals"),
      bloom: document.getElementById("bloom"),
      size: document.getElementById("size"),
      sparkle: document.getElementById("sparkle"),
      petalsV: document.getElementById("petalsV"),
      bloomV: document.getElementById("bloomV"),
      sizeV: document.getElementById("sizeV"),
      sparkleV: document.getElementById("sparkleV"),
    };

    // For smooth bloom animation
    let anim = { t: 1 }; // 0..1
    let isAnimating = false;

    function lerp(a,b,t){ return a + (b-a)*t; }
    function clamp(x,a,b){ return Math.max(a, Math.min(b, x)); }
    function rand(seed){
      // deterministic-ish RNG (Mulberry32)
      let t = seed += 0x6D2B79F5;
      t = Math.imul(t ^ (t >>> 15), t | 1);
      t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
      return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
    }

    function drawBackground(){
      const w = canvas.width, h = canvas.height;
      ctx.clearRect(0,0,w,h);

      // dark base
      const g = ctx.createLinearGradient(0,0,0,h);
      g.addColorStop(0, "#070711");
      g.addColorStop(0.55, "#12081c");
      g.addColorStop(1, "#1a0b20");
      ctx.fillStyle = g;
      ctx.fillRect(0,0,w,h);

      // soft glows
      function glow(x,y,r,rgba){
        const gg = ctx.createRadialGradient(x,y,0,x,y,r);
        gg.addColorStop(0, rgba);
        gg.addColorStop(1, "rgba(0,0,0,0)");
        ctx.fillStyle = gg;
        ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.fill();
      }
      glow(w*0.25, h*0.22, w*0.45, "rgba(255,79,147,.18)");
      glow(w*0.78, h*0.28, w*0.40, "rgba(199,178,255,.15)");
      glow(w*0.52, h*0.88, w*0.46, "rgba(255,211,138,.10)");

      // tiny stars
      ctx.fillStyle = "rgba(255,255,255,.55)";
      for(let i=0;i<120;i++){
        const x = rand(i+3)*w;
        const y = rand(i+91)*h;
        const r = 0.7 + rand(i+77)*1.2;
        ctx.globalAlpha = 0.25 + rand(i+12)*0.55;
        ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.fill();
      }
      ctx.globalAlpha = 1;
    }

    // Draw a "perfect" rose-like flower using polar petals
    function drawFlower(petals, bloom, size, sparkle, bloomAnim){
      const w = canvas.width, h = canvas.height;
      const cx = w/2, cy = h/2 + 40;

      // bloomAnim eases from 0..1
      const open = bloomAnim; // 0 closed, 1 open
      const bloomAmt = (bloom/100) * open;

      // Petal field: use many curved "petal strokes"
      // Model: r = base + k*sin(n*theta) with taper, plus spiral twist
      const n = Math.max(20, Math.floor(petals));
      const baseR = lerp(70, 160, bloomAmt);
      const maxR  = baseR + lerp(120, 350, size/100) * (0.55 + 0.45*bloomAmt);
      const twist = lerp(0.65, 1.25, bloomAmt);

      // Petal color gradients
      function petalGrad(r){
        const gg = ctx.createRadialGradient(cx,cy, r*0.05, cx,cy, r*1.05);
        gg.addColorStop(0,   "rgba(255,155,196,.15)");
        gg.addColorStop(0.25,"rgba(255,79,147,.22)");
        gg.addColorStop(0.6, "rgba(255,211,138,.10)");
        gg.addColorStop(1,   "rgba(199,178,255,.08)");
        return gg;
      }

      // center glow
      const center = ctx.createRadialGradient(cx,cy,0,cx,cy,220);
      center.addColorStop(0,"rgba(255,211,138,.20)");
      center.addColorStop(0.35,"rgba(255,79,147,.16)");
      center.addColorStop(1,"rgba(0,0,0,0)");
      ctx.fillStyle = center;
      ctx.beginPath(); ctx.arc(cx,cy,240,0,Math.PI*2); ctx.fill();

      // petals
      for(let i=0;i<n;i++){
        const theta = (i/n) * Math.PI * 2;
        const wave = Math.sin(theta * (8 + 10*bloomAmt));
        const r1 = lerp(baseR, maxR, (i/(n-1))**0.72);
        const r = r1 * (0.86 + 0.18*wave);

        const a = theta * twist + (i*0.0025);
        const x = cx + Math.cos(a)*r;
        const y = cy + Math.sin(a)*r;

        // Petal stroke thickness tapers outward
        const t = i/(n-1);
        const lw = lerp(26, 3.5, t) * (0.7 + 0.3*bloomAmt);

        ctx.strokeStyle = petalGrad(r);
        ctx.lineWidth = lw;
        ctx.lineCap = "round";

        // Curved petal: small bezier from near center to outer point
        const innerR = lerp(20, 95, bloomAmt);
        const ix = cx + Math.cos(a)*innerR;
        const iy = cy + Math.sin(a)*innerR;

        const ctrlR = lerp(80, r*0.62, bloomAmt);
        const c1x = cx + Math.cos(a - 0.25)*ctrlR;
        const c1y = cy + Math.sin(a - 0.25)*ctrlR;
        const c2x = cx + Math.cos(a + 0.25)*ctrlR;
        const c2y = cy + Math.sin(a + 0.25)*ctrlR;

        ctx.beginPath();
        ctx.moveTo(ix,iy);
        ctx.bezierCurveTo(c1x,c1y,c2x,c2y,x,y);
        ctx.stroke();
      }

      // outline shimmer ring
      ctx.globalAlpha = 0.8;
      ctx.strokeStyle = "rgba(255,247,251,.10)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.arc(cx, cy, maxR*0.56, 0, Math.PI*2);
      ctx.stroke();
      ctx.globalAlpha = 1;

      // constellation sparkles
      const sp = sparkle/100;
      const starCount = Math.floor(60 + sp*180);
      for(let i=0;i<starCount;i++){
        const r = lerp(40, maxR*0.92, rand(i+100)*rand(i+50));
        const ang = rand(i+200)*Math.PI*2;
        const x = cx + Math.cos(ang)*r;
        const y = cy + Math.sin(ang)*r;
        const s = 0.8 + rand(i+420)*2.8;
        const a = 0.12 + rand(i+999)*0.55*sp;

        ctx.fillStyle = `rgba(255,255,255,${a})`;
        ctx.beginPath(); ctx.arc(x,y,s,0,Math.PI*2); ctx.fill();

        // occasional colored star
        if(rand(i+777) < 0.08*sp){
          const tint = (rand(i+888) < 0.5) ? `rgba(255,79,147,${0.25+0.35*sp})` : `rgba(255,211,138,${0.22+0.32*sp})`;
          ctx.fillStyle = tint;
          ctx.beginPath(); ctx.arc(x+rand(i+5)*2-1, y+rand(i+6)*2-1, s*0.9, 0, Math.PI*2); ctx.fill();
        }
      }

      // stems + tiny bow at bottom
      const by = cy + maxR*0.58;
      ctx.strokeStyle = "rgba(134,255,225,.30)";
      ctx.lineWidth = 6;
      ctx.lineCap = "round";
      ctx.beginPath();
      ctx.moveTo(cx-8, by);
      ctx.quadraticCurveTo(cx-60, by+130, cx-70, h-110);
      ctx.moveTo(cx+8, by);
      ctx.quadraticCurveTo(cx+60, by+130, cx+70, h-110);
      ctx.stroke();

      // ribbon
      ctx.strokeStyle = "rgba(255,211,138,.28)";
      ctx.lineWidth = 5;
      ctx.beginPath();
      ctx.moveTo(cx-95, h-120);
      ctx.quadraticCurveTo(cx, h-150, cx+95, h-120);
      ctx.stroke();

      // tiny heart
      ctx.fillStyle = "rgba(255,79,147,.22)";
      ctx.strokeStyle = "rgba(255,79,147,.45)";
      ctx.lineWidth = 2;
      const hx = cx, hy = h-132;
      ctx.beginPath();
      ctx.moveTo(hx, hy);
      ctx.bezierCurveTo(hx-26, hy-18, hx-44, hy+12, hx, hy+34);
      ctx.bezierCurveTo(hx+44, hy+12, hx+26, hy-18, hx, hy);
      ctx.fill(); ctx.stroke();
    }

    function render(){
      const petals = +el.petals.value;
      const bloom  = +el.bloom.value;
      const size   = +el.size.value;
      const sparkle= +el.sparkle.value;

      el.petalsV.textContent = petals;
      el.bloomV.textContent  = bloom;
      el.sizeV.textContent   = size;
      el.sparkleV.textContent= sparkle;

      drawBackground();
      drawFlower(petals, bloom, size, sparkle, anim.t);
    }

    function animateBloom(){
      if(isAnimating) return;
      isAnimating = true;
      const start = performance.now();
      const from = anim.t;
      const to = (anim.t < 0.98) ? 1 : 0.72; // bloom open then settle

      function easeInOut(t){
        return t < 0.5 ? 4*t*t*t : 1 - Math.pow(-2*t+2,3)/2;
      }

      function step(now){
        const p = clamp((now - start)/900, 0, 1);
        anim.t = lerp(from, to, easeInOut(p));
        render();
        if(p < 1) requestAnimationFrame(step);
        else isAnimating = false;
      }
      requestAnimationFrame(step);
    }

    // Events
    ["petals","bloom","size","sparkle"].forEach(id=>{
      el[id].addEventListener("input", render);
    });

    document.getElementById("animateBtn").addEventListener("click", animateBloom);

    document.getElementById("saveBtn").addEventListener("click", () => {
      const a = document.createElement("a");
      a.download = "valentine-bloom.png";
      a.href = canvas.toDataURL("image/png");
      a.click();
    });

    document.getElementById("personalizeBtn").addEventListener("click", () => {
      const her = prompt("Her name (e.g., ‘Maya’):", "Maya");
      if(her === null) return;
      const you = prompt("Your name (e.g., ‘Aomsin’):", "Aomsin");
      if(you === null) return;

      document.getElementById("headline").textContent = `To ${her}, my favorite lawyer star ✦`;
      document.getElementById("subhead").innerHTML =
        `Happy Valentine’s Day, <b>${her}</b>. I know internship + studying five days a week is intense —
         so here’s a perfect flower that keeps blooming, just for you.`;
      document.getElementById("note").innerHTML =
        `<b>tiny reminder:</b> You’re allowed to be brilliant <i>and</i> soft.
         Rest is not a reward — it’s a right.
         <br><br>Always cheering for you — <b>${you}</b> ♡`;
    });

    // Initial render + slight intro bloom
    render();
    setTimeout(() => { anim.t = 0.72; render(); }, 120);
  </script>
</body>
</html>
